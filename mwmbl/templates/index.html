{% load django_vite %}
<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Metas -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  {%  include "title.html" %}
  <meta name="description" content="The free, open-source and non-profit search engine.">

  <!-- Favicons -->
  <link rel="icon" href="/static/images/favicon.svg" type="image/svg+xml">

  <!-- Fonts import -->
  <link rel="preload" href="/static/fonts/inter/inter.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript>
    <link rel="stylesheet" href="/static/fonts/inter/inter.css">
  </noscript>

  <!-- CSS Stylesheets (this is critical CSS) -->
  <link rel="stylesheet" type="text/css" href="/static/css/reset.css">
  <link rel="stylesheet" type="text/css" href="/static/css/theme.css">
  <link rel="stylesheet" type="text/css" href="/static/css/global.css">

  <!-- Phosphor Icons (https://github.com/phosphor-icons/phosphor-home) -->
  <link rel="preload" href="/static/fonts/phosphor/icons.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript>
    <link rel="stylesheet" href="/static/fonts/phosphor/icons.css">
  </noscript>

  <!-- Custom Element Polyfill for Safari -->
  <script src="https://unpkg.com/@ungap/custom-elements" type="module"></script>

  <!-- OpenSearch -->
  <link rel="search" type="application/opensearchdescription+xml" href="/static/opensearch.xml" title="Mwmbl Search">

  <script src="https://unpkg.com/htmx.org@1.9.6"></script>

  {% vite_hmr_client %}
</head>

<body>
  <mwmbl-app></mwmbl-app>
    <header class="search-menu compact">
      <a href="/" class="branding">
        <img class="brand-icon" src="/static/images/logo.svg" width="40" height="40" alt="mwmbl logo">
        <span class="brand-title">Mwmbl</span>
      </a>
      <form class="search-bar">
        <i class="ph-magnifying-glass-bold"></i>
        <input
          type='search'
          name='q'
          class='search-bar-input'
          placeholder='Search on Mwmbl...'
          title='Use "CTRL+K" or "/" to focus.'
          autocomplete='off'
          value='{{ query|default_if_none:"" }}'
          hx-get="/app/home/"
          hx-trigger="keyup changed delay:100ms"
          hx-target=".main"
        >
      </form>
      <div is="mwmbl-save"></div>
      {%  if user.is_authenticated %}
        <p class="login-info">Logged in as {{ user.username }}</p>
        <a class="button" href="/accounts/logout/">Log out</a>
      {% else %}
        <a class="button" href="/accounts/login/">Login</a>
        <a class="button" href="/accounts/signup/">Sign up</a>
      {% endif %}
    </header>
    <main>
      {%  include "home.html" %}
    </main>
    <div is="mwmbl-add-result">
      <form class="modal-content">
        <span class="close">&times;</span>
        <input class="add-result" name="new_url" placeholder="Enter a URL...">
        <button class="button"
                hx-post="/app/add/"
                hx-target=".main"
                hx-include=".result"
                hx-vals='{"query": "{{ query }}"{% if curation_id %}, "curation_id": {{ curation_id }}{% endif %}}'
                hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>Save</button>
      </form>
    </div>
  <div class="footer">
    <ul class="footer-list">
      {% for link in footer_links %}
        <li class="footer-item">
          <a href="{{ link.href }}" class="footer-link" target="__blank">
            <i class="{{ link.icon }}"></i>
            <span>{{ link.name }}</span>
          </a>
        </li>
      {% endfor %}
    </ul>
  </div>
{% vite_asset 'index.js' %}
{% vite_legacy_polyfills %}
{% vite_legacy_asset 'index-legacy.js' %}
</body>

</html>